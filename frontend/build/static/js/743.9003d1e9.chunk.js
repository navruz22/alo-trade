"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[743],{1743:function(e,n,l){l.r(n),l.d(n,{default:function(){return Z}});var t=l(4942),r=l(9439),s=l(2791),a=l(71),i=l(3479),d=l(184),o=function(e){var n=e.offer,l=e.user,t=e.changeOffer,r=null===l||void 0===l?void 0:l._id,s=n.order,o=n.product,c=n.messages,u=n.createdAt,x=n.offererUser,f=s?s.name:o?o.name:"",m=c.message,h=c.isRead,v=c.user,p=s?s.images[0]:o?o.images[0]:null,g=x._id===r,j=v!==(null===l||void 0===l?void 0:l._id)&&!h;return(0,d.jsxs)("div",{onClick:t,className:"bg-white flex items-center hover:bg-grey-lighter cursor-pointer flex-row border-b pl-3",children:[(0,d.jsxs)("div",{children:[p?(0,d.jsx)("img",{alt:"alotrade.uz",className:"h-12 w-12 rounded-full",src:p}):(0,d.jsx)("div",{className:"h-12 w-12 rounded-full border-dashed bg-neutral-200 flex items-center justify-center",children:"IMG"}),(0,d.jsx)("p",{className:"text-xs text-neutral-600 mt-2",children:new Date(u).toLocaleDateString()})]}),(0,d.jsxs)("div",{className:"ml-4 flex-1 py-4 pr-2",children:[(0,d.jsxs)("div",{className:"flex items-bottom justify-between",children:[(0,d.jsx)("p",{className:"text-neutral-500 font-amazonbold h-6 overflow-hidden",children:f}),j&&(0,d.jsx)(i.RL9,{className:"fill-green-500",size:20})]}),(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("p",{className:"text-neutral-500 mt-1 text-sm h-6 overflow-hidden",children:m&&m}),(0,d.jsx)("p",{className:"text-xs text-neutral-600",children:g?(0,d.jsx)(a.uiN,{size:15,className:"rotate-45"}):(0,d.jsx)(a.xW6,{size:15,className:"rotate-45"})})]})]})]})},c=l(763),u=l(2111),x=l.n(u),f=l(1087),m=function(e){var n,l,t,r,s,i,o=e.data,u=e.translations;if(!o)return null;var m=null===o||void 0===o?void 0:o.organization,h=null===o||void 0===o?void 0:o.user,v=m?u.tashkilot+": "+(null===m||void 0===m?void 0:m.name):u.foydalanuvchi+": "+(null===h||void 0===h?void 0:h.firstname)+" "+(null===h||void 0===h?void 0:h.lastname);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("h2",{className:"font-amazonbold py-2 text-lg border-y border-neutral-300",children:v}),(0,d.jsx)("h3",{className:"font-amazonbold py-1 font-bold",children:null===o||void 0===o?void 0:o.name}),(0,d.jsx)("h4",{className:"py-2 mb-2 block max-w-[300px]",children:(0,d.jsx)(x(),{element:"p",line:3,text:null===o||void 0===o?void 0:o.description})}),(0,d.jsxs)("p",{className:"flex items-center text-neutral-600 text-sm",children:[(0,d.jsx)("span",{className:"mr-2",children:(0,d.jsx)(a.kXE,{})}),(0,d.jsxs)("span",{children:[null===o||void 0===o||null===(n=o.region)||void 0===n?void 0:n.name,", ",null===o||void 0===o||null===(l=o.district)||void 0===l?void 0:l.name]})]}),(0,d.jsxs)("p",{className:"flex items-center text-neutral-600 text-sm",children:[(0,d.jsx)("span",{className:"mr-2",children:(0,d.jsx)(a.Ty1,{})}),(0,d.jsx)("span",{children:(null===o||void 0===o||null===(t=o.organization)||void 0===t?void 0:t.phone)||(null===o||void 0===o||null===(r=o.user)||void 0===r?void 0:r.phone)})]}),(0,d.jsx)(f.rU,{to:m?"/products/".concat(o._id):"/orders/".concat(o._id),className:"bg-orange-500 text-[12px] my-4 md:text-[16px] shadow-lg shadow- shadow-orange-600 text-white cursor-pointer px-3 py-1 text-center justify-center items-center rounded-xl flex space-x-2 flex-row",children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"}),(0,d.jsxs)("p",{className:"flex items-center justify-between text-neutral-600 text-lg py-2 my-2 border-y border-neutral-300",children:[(0,d.jsxs)("span",{className:"pr-2 font-amazonbold",children:[u.narxi,": "]})," ",(0,d.jsxs)("span",{className:"text-amber-500 font-bold font-amazonbold ",children:[null!==o&&void 0!==o&&o.minPrice?(null===o||void 0===o||null===(s=o.minPrice)||void 0===s?void 0:s.toLocaleString("ru-RU"))+" - ":""," ",null===o||void 0===o||null===(i=o.maxPrice)||void 0===i?void 0:i.toLocaleString("ru-RU")," ",null===o||void 0===o?void 0:o.currency]})]}),(0,d.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(null===o||void 0===o?void 0:o.images)&&(0,c.map)(null===o||void 0===o?void 0:o.images,(function(e){return(0,d.jsx)("div",{className:"w-full flex items-center justify-center rounded bg-white-900 ",children:(0,d.jsx)("img",{className:"",alt:"alotrade",src:e})},(0,c.uniqueId)("productImage"))}))})]})},h=function(e){var n=e.message,l=n.message,t=n.user,r=n.createdAt;return(0,d.jsxs)("div",{className:"w-full flex flex-row gap-1 ml-1 my-3",children:[(0,d.jsx)("div",{className:"rounded-full bg-white w-15 flex justify-center items-center",children:null!==t&&void 0!==t&&t.image?(0,d.jsx)("img",{src:t.image,alt:"Alotarade",className:"w-12 h-12 rounded-full"}):(0,d.jsxs)("div",{className:"w-12 h-12 rounded-full uppercase flex items-center justify-center bg-white-900",children:[null===t||void 0===t?void 0:t.firstname[0],null===t||void 0===t?void 0:t.lastname[0]]})}),(0,d.jsxs)("div",{className:"w-2/3 bg-white rounded shadow-md px-2",children:[(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsxs)("h3",{className:"font-amazonbold text-neutral-500 text-[15px]",children:[null===t||void 0===t?void 0:t.firstname," ",null===t||void 0===t?void 0:t.lastname]}),(0,d.jsxs)("p",{className:"text-[12px] text-neutral-500 text-end",children:[new Date(r).toLocaleTimeString().slice(0,5)," ",new Date(r).toLocaleDateString()]})]}),(0,d.jsx)("p",{className:"text-neutral-600",children:l})]})]})},v=function(e){var n=e.message,l=n.message,t=n.user,r=n.createdAt;return(0,d.jsxs)("div",{className:"w-full flex flex-row my-3 gap-1 justify-end",children:[(0,d.jsxs)("div",{className:"w-2/3 bg-white rounded shadow-md px-2",children:[(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsxs)("h3",{className:"font-amazonbold text-neutral-500 text-[15px]",children:[null===t||void 0===t?void 0:t.firstname," ",null===t||void 0===t?void 0:t.lastname]}),(0,d.jsxs)("p",{className:"text-[12px] text-neutral-500 text-end",children:[new Date(r).toLocaleTimeString().slice(0,5)," ",new Date(r).toLocaleDateString()]})]}),(0,d.jsx)("p",{className:"text-neutral-600",children:l})]}),(0,d.jsx)("div",{className:"rounded-full bg-white mr-1 w-15 flex justify-center items-center",children:null!==t&&void 0!==t&&t.image?(0,d.jsx)("img",{src:t.image,alt:"Alotarade",className:"w-12 h-12 rounded-full"}):(0,d.jsxs)("div",{className:"w-12 h-12 rounded-full uppercase flex items-center justify-center bg-white-900",children:[null===t||void 0===t?void 0:t.firstname[0],null===t||void 0===t?void 0:t.lastname[0]]})})]})},p=l(9169),g=l(3168),j=function(e){var n=e.changeHandler,l=e.enterHandler,t=e.sendHandler,r=e.value,s=(0,g.$)().t,i=(0,p.F)(s).xabarni_kiriting;return(0,d.jsxs)("div",{className:"bg-white-900 w-full h-[5rem] px-10 py-5 flex",children:[(0,d.jsx)("input",{value:r,onKeyUp:l,onChange:n,placeholder:i,className:"border rounded-l w-full py-1 px-3 outline-0"}),(0,d.jsx)("button",{onClick:t,className:"px-3 border-r border-y text-neutral-500 rounded-r",children:(0,d.jsx)(a.yhK,{color:"#fff"})})]})},w=l(9434),b=l(7689),N=l(8285),y=l(6691),_=l(2106),k=l(9917),S=(0,l(2317).ZP)("http://185.107.237.60/"),U=JSON.parse(localStorage.getItem("_grecaptcha"));S.auth={token:U};var z=S,I=l(4397),C=function(e){var n=e.data,l=null===n||void 0===n?void 0:n.organization;return(0,d.jsx)(f.rU,{to:l?"/products/".concat(null===n||void 0===n?void 0:n._id):"/orders/".concat(null===n||void 0===n?void 0:n._id),className:"text-white text-[14px] font-medium bg-orange-500 px-2 flex items-center justify-center",children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"})},Z=function(){var e=(0,w.I0)(),n=(0,b.TH)(),l=(0,g.$)(["common"]).t,a=(0,p.F)(l),i=(0,I.Z)().width,u=(0,s.useRef)(null),x=(0,w.v9)((function(e){return e.login})).userData.user,f=(0,w.v9)((function(e){return e.offers})),S=f.offers,U=f.messages,Z=(0,s.useState)(null),D=(0,r.Z)(Z,2),H=D[0],q=D[1],E=(0,s.useState)(null),L=(0,r.Z)(E,2),R=L[0],T=L[1],A=(0,s.useState)(null),F=(0,r.Z)(A,2),O=F[0],P=F[1],M=(0,s.useState)(null),K=(0,r.Z)(M,2),Q=K[0],$=K[1],G=(0,s.useState)(""),J=(0,r.Z)(G,2),V=J[0],W=J[1],X=(0,s.useState)(null),B=(0,r.Z)(X,2),Y=B[0],ee=B[1],ne=(0,s.useState)(null),le=(0,r.Z)(ne,2),te=le[0],re=le[1],se=(0,s.useState)(!1),ae=(0,r.Z)(se,2),ie=ae[0],de=ae[1],oe=function(e){var n=e.target.name;re(n===te?null:e.target.name)},ce=function(e){W(e.target.value)},ue=function(e){"Enter"===e.key&&xe()},xe=function(){if(0===V.length)return(0,_.Ug)("\u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435! \u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043d\u0435 \u0432\u0432\u0435\u0434\u0435\u043d\u043e","warning");if(!O&&!Q)return(0,_.Ug)(a.mahsulot_yoki_buyurtma_tanlanmagan,"warning");var n={message:V,product:O?O._id:void 0,order:Q?Q._id:void 0,offer:Y?Y._id:void 0};e(Y?(0,k.tn)(n):(0,k.Cm)(n)).then((function(e){var n=e.error,l=e.payload,t=l.offer,r=l.message;n||(W(""),ee(t),he({recipient:null===r||void 0===r?void 0:r.recipient}))}))},fe=function(e){e.order&&(T("order"),q(e.order._id)),e.product&&(e.product&&T("product"),e.product&&q(e.product._id)),ee(e),de(!0)},me=function(e){return(null===e||void 0===e?void 0:e._id)===(null===x||void 0===x?void 0:x._id)},he=function(e){var n=e.recipient;z.emit("sendMessage",{recipient:n})};return(0,s.useEffect)((function(){!function(){var e;null===(e=u.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}()}),[U]),(0,s.useEffect)((function(){z.on("error",(function(e){var n=e.id,l=e.message;x._id===n&&(0,_.Ug)(l,"error")})),z.on("newMessage",(function(n){var l=n.recipient===x._id;l&&e((0,k.Rg)()),l&&Y&&e((0,k.Qi)({id:Y._id})).then((function(n){n.error||e((0,k.jd)({id:Y._id}))}))}))}),[x,e,Y]),(0,s.useEffect)((function(){if(n.state){var l=n.state.type,r=n.state.id;q(r),T(l);var s=(0,t.Z)({},l,r);e((0,k.qU)(s)).then((function(n){var l=n.error,t=n.payload.offer;l||(ee(t),!t&&e((0,k.nT)({messages:[]})))}))}else e((0,k.nT)({messages:[]})),$(null),P(null)}),[n.state,e]),(0,s.useEffect)((function(){H&&("product"===R&&e((0,N.D)({id:H})).then((function(e){var n=e.error,l=e.payload.product;n||($(null),P(l))})),"order"===R&&e((0,y.nF)({id:H})).then((function(e){var n=e.error,l=e.payload.order;n||(P(null),$(l))}))),de(!0)}),[H,R,e]),(0,s.useEffect)((function(){e((0,k.Rg)({filter:te}))}),[e,te,x]),(0,s.useEffect)((function(){Y&&e((0,k.Qi)({id:Y._id})).then((function(n){n.error||e((0,k.jd)({id:Y._id}))}))}),[e,Y]),i<720?(0,d.jsxs)("div",{className:"flex flex-row h-full w-full relative",children:[(0,d.jsxs)("div",{className:"w-full md:max-w-[400px] md:min-w-[300px] md:w-1/4 h-full flex border-r-2 flex-col",children:[(0,d.jsxs)("div",{class:"flex justify-between md:gap-4 md:justify-center mb-[20px]",children:[(0,d.jsx)("button",{name:"offererUser",className:"block w-full md:w-auto uppercase shadow md:ml-0 rounded-tr-none rounded-br-none border-r-0 border-1 border-[#03c1f6cc] ".concat("offererUser"===te?"bg-alotrade text-white":" bg-white text-[#00c2cb]"," font-bold focus:shadow-outline focus:outline-none text-white md:text-xs text-[10px] py-3 md:px-10 px-2"),onClick:oe,children:"\u0418\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0435"}),(0,d.jsx)("button",{name:"user",className:"block w-full md:w-auto uppercase shadow md:ml-0 rounded-tl-none rounded-bl-none border-l-0 border-1 border-[#03c1f6cc] ".concat("user"===te?"bg-alotrade text-white":" bg-white text-alotrade"," font-bold focus:shadow-outline focus:outline-none text-white md:text-xs text-[10px] py-3 md:px-10 px-2"),onClick:oe,children:"\u0412\u0445\u043e\u0434\u044f\u0449\u0438\u0435"})]}),(0,d.jsx)("div",{className:"h-full w-full px-3 overflow-y-scroll",children:(0,c.map)(S,(function(e){return(0,d.jsx)(o,{changeOffer:function(){return fe(e)},user:x,offer:e},(0,c.uniqueId)("chatUser"))}))})]}),(0,d.jsxs)("div",{className:"h-full ".concat(ie?"fixed top-0 left-0 w-full h-full z-50":"hidden"," md:w-1/2 md:relative bg-alotrade flex flex-col"),children:[(0,d.jsxs)("div",{className:"bg-alotrade border-b border-white h-[50px] flex justify-between pl-2",children:[(0,d.jsx)("button",{onClick:function(){return de(!1)},className:"text-white text-[14px] font-medium",children:"\u041d\u0430\u0437\u0430\u0434"}),(0,d.jsx)(C,{data:O||Q})]}),(0,d.jsxs)("div",{className:"h-full overflow-y-scroll",children:[(0,c.map)(U,(function(e){return me(e.user)?(0,d.jsx)(v,{message:e},(0,c.uniqueId)("message")):(0,d.jsx)(h,{message:e},(0,c.uniqueId)("message"))})),(0,d.jsx)("div",{className:"",ref:u})]}),(0,d.jsx)(j,{value:V,changeHandler:ce,enterHandler:ue,sendHandler:xe})]})]}):(0,d.jsxs)("div",{className:"flex flex-row h-screen w-full ",children:[(0,d.jsxs)("div",{className:"max-w-[400px] min-w-[300px] w-1/4 h-full flex border-r-2 flex-col",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("button",{onClick:oe,name:"offererUser",className:"w-1/2 py-2 ".concat("offererUser"===te?"bg-primary-700":"bg-primary-800"," text-white-900 border-r border-white-900"),children:a.chiquvchi_xabar}),(0,d.jsx)("button",{onClick:oe,name:"user",className:"w-1/2 py-2 ".concat("user"===te?"bg-primary-700":"bg-primary-800"," text-white-900"),children:a.kiruvchi_xabar})]}),(0,d.jsx)("div",{className:"h-full w-full px-3",children:(0,c.map)(S,(function(e){return(0,d.jsx)(o,{changeOffer:function(){return fe(e)},user:x,offer:e},(0,c.uniqueId)("chatUser"))}))})]}),(0,d.jsxs)("div",{className:"h-full w-1/2 relative bg-alotrade flex flex-col",children:[(0,d.jsxs)("div",{className:"h-full",children:[(0,c.map)(U,(function(e){return me(e.user)?(0,d.jsx)(v,{message:e},(0,c.uniqueId)("message")):(0,d.jsx)(h,{message:e},(0,c.uniqueId)("message"))})),(0,d.jsx)("div",{className:"",ref:u})]}),(0,d.jsx)(j,{value:V,changeHandler:ce,enterHandler:ue,sendHandler:xe})]}),(0,d.jsx)("div",{className:"max-w-[400px] min-w-[300px] w-1/4 h-full p-4 border-l-2 bg-white",children:(0,d.jsx)(m,{data:O||Q,translations:a})})]})}}}]);
//# sourceMappingURL=743.9003d1e9.chunk.js.map