"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[743],{1743:function(e,n,l){l.r(n),l.d(n,{default:function(){return C}});var t=l(4942),r=l(9439),s=l(2791),a=l(71),i=l(184),d=function(e){var n=e.offer,l=e.user,t=e.changeOffer,r=null===l||void 0===l?void 0:l._id,s=n.order,d=n.product,o=n.messages,c=n.createdAt,u=n.offererUser,x=s?s.name:d?d.name:"",f=o.message,m=o.isRead,h=o.user,v=s?s.images[0]:d?d.images[0]:null,p=u._id===r,g=h!==(null===l||void 0===l?void 0:l._id)&&!m;return(0,i.jsxs)("div",{onClick:t,className:"bg-white flex items-center hover:bg-grey-lighter cursor-pointer flex-row border-b pl-3",children:[(0,i.jsx)("div",{children:v?(0,i.jsx)("img",{alt:"alotrade.uz",className:"h-12 w-12 rounded-full",src:v}):(0,i.jsx)("div",{className:"h-12 w-12 rounded-full border-dashed bg-neutral-200 flex items-center justify-center",children:"IMG"})}),(0,i.jsxs)("div",{className:"ml-4 flex-1 py-4 pr-2",children:[(0,i.jsxs)("div",{className:"flex items-bottom justify-between",children:[(0,i.jsx)("p",{className:"text-neutral-500 font-amazonbold h-6 overflow-hidden",children:x}),(0,i.jsx)("p",{className:"text-xs text-neutral-600",children:new Date(c).toLocaleDateString()})]}),(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("p",{className:"text-neutral-500 mt-1 text-sm h-6 overflow-hidden",children:f&&f}),g&&(0,i.jsx)("p",{className:"text-[10px] bg-green-500 px-2 text-red-600 rounded-md ",children:"new"}),(0,i.jsx)("p",{className:"text-xs text-neutral-600",children:p?(0,i.jsx)(a.uiN,{size:15,className:"rotate-45"}):(0,i.jsx)(a.xW6,{size:15,className:"rotate-45"})})]})]})]})},o=l(763),c=l(2111),u=l.n(c),x=l(1087),f=function(e){var n,l,t,r,s,d,c=e.data,f=e.translations;if(!c)return null;var m=null===c||void 0===c?void 0:c.organization,h=null===c||void 0===c?void 0:c.user,v=m?f.tashkilot+": "+(null===m||void 0===m?void 0:m.name):f.foydalanuvchi+": "+(null===h||void 0===h?void 0:h.firstname)+" "+(null===h||void 0===h?void 0:h.lastname);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h2",{className:"font-amazonbold py-2 text-lg border-y border-neutral-300",children:v}),(0,i.jsx)("h3",{className:"font-amazonbold py-1 font-bold",children:null===c||void 0===c?void 0:c.name}),(0,i.jsx)("h4",{className:"py-2 mb-2 block max-w-[300px]",children:(0,i.jsx)(u(),{element:"p",line:3,text:null===c||void 0===c?void 0:c.description})}),(0,i.jsxs)("p",{className:"flex items-center text-neutral-600 text-sm",children:[(0,i.jsx)("span",{className:"mr-2",children:(0,i.jsx)(a.kXE,{})}),(0,i.jsxs)("span",{children:[null===c||void 0===c||null===(n=c.region)||void 0===n?void 0:n.name,", ",null===c||void 0===c||null===(l=c.district)||void 0===l?void 0:l.name]})]}),(0,i.jsxs)("p",{className:"flex items-center text-neutral-600 text-sm",children:[(0,i.jsx)("span",{className:"mr-2",children:(0,i.jsx)(a.Ty1,{})}),(0,i.jsx)("span",{children:(null===c||void 0===c||null===(t=c.organization)||void 0===t?void 0:t.phone)||(null===c||void 0===c||null===(r=c.user)||void 0===r?void 0:r.phone)})]}),(0,i.jsx)(x.rU,{to:m?"/products/".concat(c._id):"/orders/".concat(c._id),className:"bg-orange-500 text-[12px] my-4 md:text-[16px] shadow-lg shadow- shadow-orange-600 text-white cursor-pointer px-3 py-1 text-center justify-center items-center rounded-xl flex space-x-2 flex-row",children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"}),(0,i.jsxs)("p",{className:"flex items-center justify-between text-neutral-600 text-lg py-2 my-2 border-y border-neutral-300",children:[(0,i.jsxs)("span",{className:"pr-2 font-amazonbold",children:[f.narxi,": "]})," ",(0,i.jsxs)("span",{className:"text-amber-500 font-bold font-amazonbold ",children:[null!==c&&void 0!==c&&c.minPrice?(null===c||void 0===c||null===(s=c.minPrice)||void 0===s?void 0:s.toLocaleString("ru-RU"))+" - ":""," ",null===c||void 0===c||null===(d=c.maxPrice)||void 0===d?void 0:d.toLocaleString("ru-RU")," ",null===c||void 0===c?void 0:c.currency]})]}),(0,i.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(null===c||void 0===c?void 0:c.images)&&(0,o.map)(null===c||void 0===c?void 0:c.images,(function(e){return(0,i.jsx)("div",{className:"w-full flex items-center justify-center rounded bg-white-900 ",children:(0,i.jsx)("img",{className:"",alt:"alotrade",src:e})},(0,o.uniqueId)("productImage"))}))})]})},m=function(e){var n=e.message,l=n.message,t=n.user,r=n.createdAt;return(0,i.jsxs)("div",{className:"w-full flex flex-row gap-1 ml-1 my-3",children:[(0,i.jsx)("div",{className:"rounded-full bg-white w-15 flex justify-center items-center",children:null!==t&&void 0!==t&&t.image?(0,i.jsx)("img",{src:t.image,alt:"Alotarade",className:"w-12 h-12 rounded-full"}):(0,i.jsxs)("div",{className:"w-12 h-12 rounded-full uppercase flex items-center justify-center bg-white-900",children:[null===t||void 0===t?void 0:t.firstname[0],null===t||void 0===t?void 0:t.lastname[0]]})}),(0,i.jsxs)("div",{className:"w-2/3 bg-white rounded shadow-md px-2",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)("h3",{className:"font-amazonbold text-neutral-500 text-[15px]",children:[null===t||void 0===t?void 0:t.firstname," ",null===t||void 0===t?void 0:t.lastname]}),(0,i.jsxs)("p",{className:"text-[12px] text-neutral-500 text-end",children:[new Date(r).toLocaleTimeString().slice(0,5)," ",new Date(r).toLocaleDateString()]})]}),(0,i.jsx)("p",{className:"text-neutral-600",children:l})]})]})},h=function(e){var n=e.message,l=n.message,t=n.user,r=n.createdAt;return(0,i.jsxs)("div",{className:"w-full flex flex-row my-3 gap-1 justify-end",children:[(0,i.jsxs)("div",{className:"w-2/3 bg-white rounded shadow-md px-2",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)("h3",{className:"font-amazonbold text-neutral-500 text-[15px]",children:[null===t||void 0===t?void 0:t.firstname," ",null===t||void 0===t?void 0:t.lastname]}),(0,i.jsxs)("p",{className:"text-[12px] text-neutral-500 text-end",children:[new Date(r).toLocaleTimeString().slice(0,5)," ",new Date(r).toLocaleDateString()]})]}),(0,i.jsx)("p",{className:"text-neutral-600",children:l})]}),(0,i.jsx)("div",{className:"rounded-full bg-white mr-1 w-15 flex justify-center items-center",children:null!==t&&void 0!==t&&t.image?(0,i.jsx)("img",{src:t.image,alt:"Alotarade",className:"w-12 h-12 rounded-full"}):(0,i.jsxs)("div",{className:"w-12 h-12 rounded-full uppercase flex items-center justify-center bg-white-900",children:[null===t||void 0===t?void 0:t.firstname[0],null===t||void 0===t?void 0:t.lastname[0]]})})]})},v=l(9169),p=l(3168),g=function(e){var n=e.changeHandler,l=e.enterHandler,t=e.sendHandler,r=e.value,s=(0,p.$)().t,d=(0,v.F)(s).xabarni_kiriting;return(0,i.jsxs)("div",{className:"bg-white-900 w-full h-[5rem] px-10 py-5 flex",children:[(0,i.jsx)("input",{value:r,onKeyUp:l,onChange:n,placeholder:d,className:"border rounded-l w-full py-1 px-3 outline-0"}),(0,i.jsx)("button",{onClick:t,className:"px-3 border-r border-y text-neutral-500 rounded-r",children:(0,i.jsx)(a.yhK,{color:"#fff"})})]})},j=l(9434),w=l(7689),b=l(8285),N=l(6691),y=l(2106),_=l(9917),k=(0,l(2317).ZP)("http://185.107.237.60/"),S=JSON.parse(localStorage.getItem("_grecaptcha"));k.auth={token:S};var U=k,z=l(4397),I=function(e){var n=e.data,l=null===n||void 0===n?void 0:n.organization;return(0,i.jsx)(x.rU,{to:l?"/products/".concat(null===n||void 0===n?void 0:n._id):"/orders/".concat(null===n||void 0===n?void 0:n._id),className:"text-white text-[14px] font-medium bg-orange-500 px-2 flex items-center justify-center",children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"})},C=function(){var e=(0,j.I0)(),n=(0,w.TH)(),l=(0,p.$)(["common"]).t,a=(0,v.F)(l),c=(0,z.Z)().width,u=(0,s.useRef)(null),x=(0,j.v9)((function(e){return e.login})).userData.user,k=(0,j.v9)((function(e){return e.offers})),S=k.offers,C=k.messages,Z=(0,s.useState)(null),D=(0,r.Z)(Z,2),H=D[0],q=D[1],E=(0,s.useState)(null),L=(0,r.Z)(E,2),R=L[0],T=L[1],A=(0,s.useState)(null),F=(0,r.Z)(A,2),O=F[0],P=F[1],M=(0,s.useState)(null),K=(0,r.Z)(M,2),Q=K[0],$=K[1],G=(0,s.useState)(""),J=(0,r.Z)(G,2),V=J[0],W=J[1],X=(0,s.useState)(null),B=(0,r.Z)(X,2),Y=B[0],ee=B[1],ne=(0,s.useState)(null),le=(0,r.Z)(ne,2),te=le[0],re=le[1],se=(0,s.useState)(!1),ae=(0,r.Z)(se,2),ie=ae[0],de=ae[1],oe=function(e){var n=e.target.name;re(n===te?null:e.target.name)},ce=function(e){W(e.target.value)},ue=function(e){"Enter"===e.key&&xe()},xe=function(){if(0===V.length)return(0,y.Ug)("\u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435! \u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043d\u0435 \u0432\u0432\u0435\u0434\u0435\u043d\u043e","warning");if(!O&&!Q)return(0,y.Ug)(a.mahsulot_yoki_buyurtma_tanlanmagan,"warning");var n={message:V,product:O?O._id:void 0,order:Q?Q._id:void 0,offer:Y?Y._id:void 0};e(Y?(0,_.tn)(n):(0,_.Cm)(n)).then((function(e){var n=e.error,l=e.payload,t=l.offer,r=l.message;n||(W(""),ee(t),he({recipient:null===r||void 0===r?void 0:r.recipient}))}))},fe=function(e){e.order&&(T("order"),q(e.order._id)),e.product&&(e.product&&T("product"),e.product&&q(e.product._id)),ee(e),de(!0)},me=function(e){return(null===e||void 0===e?void 0:e._id)===(null===x||void 0===x?void 0:x._id)},he=function(e){var n=e.recipient;U.emit("sendMessage",{recipient:n})};return(0,s.useEffect)((function(){!function(){var e;null===(e=u.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}()}),[C]),(0,s.useEffect)((function(){U.on("error",(function(e){var n=e.id,l=e.message;x._id===n&&(0,y.Ug)(l,"error")})),U.on("newMessage",(function(n){var l=n.recipient===x._id;l&&e((0,_.Rg)()),l&&Y&&e((0,_.Qi)({id:Y._id})).then((function(n){n.error||e((0,_.jd)({id:Y._id}))}))}))}),[x,e,Y]),(0,s.useEffect)((function(){if(n.state){var l=n.state.type,r=n.state.id;q(r),T(l);var s=(0,t.Z)({},l,r);e((0,_.qU)(s)).then((function(n){var l=n.error,t=n.payload.offer;l||(ee(t),!t&&e((0,_.nT)({messages:[]})))}))}else e((0,_.nT)({messages:[]})),$(null),P(null)}),[n.state,e]),(0,s.useEffect)((function(){H&&("product"===R&&e((0,b.D)({id:H})).then((function(e){var n=e.error,l=e.payload.product;n||($(null),P(l))})),"order"===R&&e((0,N.nF)({id:H})).then((function(e){var n=e.error,l=e.payload.order;n||(P(null),$(l))}))),de(!0)}),[H,R,e]),(0,s.useEffect)((function(){e((0,_.Rg)({filter:te}))}),[e,te,x]),(0,s.useEffect)((function(){Y&&e((0,_.Qi)({id:Y._id})).then((function(n){n.error||e((0,_.jd)({id:Y._id}))}))}),[e,Y]),c<720?(0,i.jsxs)("div",{className:"flex flex-row h-full w-full relative",children:[(0,i.jsxs)("div",{className:"w-full md:max-w-[400px] md:min-w-[300px] md:w-1/4 h-full flex border-r-2 flex-col",children:[(0,i.jsxs)("div",{class:"flex justify-between md:gap-4 md:justify-center mb-[20px]",children:[(0,i.jsx)("button",{name:"offererUser",className:"block w-full md:w-auto uppercase shadow md:ml-0 rounded-tr-none rounded-br-none border-r-0 border-1 border-[#03c1f6cc] ".concat("offererUser"===te?"bg-alotrade text-white":" bg-white text-[#00c2cb]"," font-bold focus:shadow-outline focus:outline-none text-white md:text-xs text-[10px] py-3 md:px-10 px-2"),onClick:oe,children:"\u0418\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0435"}),(0,i.jsx)("button",{name:"user",className:"block w-full md:w-auto uppercase shadow md:ml-0 rounded-tl-none rounded-bl-none border-l-0 border-1 border-[#03c1f6cc] ".concat("user"===te?"bg-alotrade text-white":" bg-white text-alotrade"," font-bold focus:shadow-outline focus:outline-none text-white md:text-xs text-[10px] py-3 md:px-10 px-2"),onClick:oe,children:"\u0412\u0445\u043e\u0434\u044f\u0449\u0438\u0435"})]}),(0,i.jsx)("div",{className:"h-full w-full px-3 overflow-y-scroll",children:(0,o.map)(S,(function(e){return(0,i.jsx)(d,{changeOffer:function(){return fe(e)},user:x,offer:e},(0,o.uniqueId)("chatUser"))}))})]}),(0,i.jsxs)("div",{className:"h-full ".concat(ie?"fixed top-0 left-0 w-full h-full z-50":"hidden"," md:w-1/2 md:relative bg-alotrade flex flex-col"),children:[(0,i.jsxs)("div",{className:"bg-alotrade border-b border-white h-[50px] flex justify-between pl-2",children:[(0,i.jsx)("button",{onClick:function(){return de(!1)},className:"text-white text-[14px] font-medium",children:"\u041d\u0430\u0437\u0430\u0434"}),(0,i.jsx)(I,{data:O||Q})]}),(0,i.jsxs)("div",{className:"h-full overflow-y-scroll",children:[(0,o.map)(C,(function(e){return me(e.user)?(0,i.jsx)(h,{message:e},(0,o.uniqueId)("message")):(0,i.jsx)(m,{message:e},(0,o.uniqueId)("message"))})),(0,i.jsx)("div",{className:"",ref:u})]}),(0,i.jsx)(g,{value:V,changeHandler:ce,enterHandler:ue,sendHandler:xe})]})]}):(0,i.jsxs)("div",{className:"flex flex-row h-screen w-full ",children:[(0,i.jsxs)("div",{className:"max-w-[400px] min-w-[300px] w-1/4 h-full flex border-r-2 flex-col",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{onClick:oe,name:"offererUser",className:"w-1/2 py-2 ".concat("offererUser"===te?"bg-primary-700":"bg-primary-800"," text-white-900 border-r border-white-900"),children:a.chiquvchi_xabar}),(0,i.jsx)("button",{onClick:oe,name:"user",className:"w-1/2 py-2 ".concat("user"===te?"bg-primary-700":"bg-primary-800"," text-white-900"),children:a.kiruvchi_xabar})]}),(0,i.jsx)("div",{className:"h-full w-full px-3",children:(0,o.map)(S,(function(e){return(0,i.jsx)(d,{changeOffer:function(){return fe(e)},user:x,offer:e},(0,o.uniqueId)("chatUser"))}))})]}),(0,i.jsxs)("div",{className:"h-full w-1/2 relative bg-alotrade flex flex-col",children:[(0,i.jsxs)("div",{className:"h-full",children:[(0,o.map)(C,(function(e){return me(e.user)?(0,i.jsx)(h,{message:e},(0,o.uniqueId)("message")):(0,i.jsx)(m,{message:e},(0,o.uniqueId)("message"))})),(0,i.jsx)("div",{className:"",ref:u})]}),(0,i.jsx)(g,{value:V,changeHandler:ce,enterHandler:ue,sendHandler:xe})]}),(0,i.jsx)("div",{className:"max-w-[400px] min-w-[300px] w-1/4 h-full p-4 border-l-2 bg-white",children:(0,i.jsx)(f,{data:O||Q,translations:a})})]})}}}]);
//# sourceMappingURL=743.d6211883.chunk.js.map